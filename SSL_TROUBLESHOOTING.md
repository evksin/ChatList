# Устранение проблем с SSL

## Проблема: SSL ошибки при подключении к OpenRouter API

Если вы получаете ошибки типа `SSLError` или `SSL: CERTIFICATE_VERIFY_FAILED`, попробуйте следующие решения:

## Решение 1: Обновление SSL сертификатов (Рекомендуется)

### Автоматическое обновление

1. Откройте PowerShell **от имени администратора**
2. Перейдите в папку проекта:
   ```powershell
   cd C:\Work\ChatList
   ```
3. Запустите скрипт обновления:
   ```powershell
   .\update_ssl.ps1
   ```

### Ручное обновление

1. **Обновление Python пакетов:**
   ```powershell
   python -m pip install --upgrade certifi requests urllib3
   ```

2. **Обновление сертификатов certifi:**
   ```powershell
   python -c "import certifi; import urllib.request; urllib.request.urlretrieve('https://curl.se/ca/cacert.pem', certifi.where())"
   ```

3. **Обновление Windows:**
   - Откройте "Параметры" → "Обновление и безопасность"
   - Нажмите "Проверка наличия обновлений"
   - Установите все доступные обновления

## Решение 2: Обновление Windows и сертификатов

1. **Обновление Windows:**
   - Нажмите `Win + I` → "Обновление и безопасность"
   - Нажмите "Проверка наличия обновлений"
   - Установите все обновления, особенно обновления безопасности

2. **Обновление корневых сертификатов:**
   - Откройте "Панель управления" → "Доверенные корневые центры сертификации"
   - Или выполните в PowerShell (от администратора):
     ```powershell
     certutil -generateSSTFromWU roots.sst
     certutil -addstore -f root roots.sst
     ```

## Решение 3: Временное отключение проверки SSL (НЕ рекомендуется)

⚠️ **ВНИМАНИЕ:** Это снижает безопасность соединения. Используйте только для диагностики!

1. Создайте файл `.env` в корне проекта (если его нет)
2. Добавьте строку:
   ```
   DISABLE_SSL_VERIFY=true
   ```
3. Перезапустите приложение

Или установите переменную окружения:
```powershell
$env:PYTHONHTTPSVERIFY=0
```

## Решение 4: Проверка сетевых настроек

1. **Проверка прокси:**
   - Если вы используете прокси, убедитесь, что он правильно настроен
   - Проверьте настройки прокси в Windows:
     - Настройки → Сеть и Интернет → Прокси

2. **Проверка файрвола:**
   - Временно отключите файрвол Windows для теста
   - Если это помогло, добавьте исключение для Python

3. **Проверка антивируса:**
   - Временно отключите антивирус для теста
   - Если это помогло, добавьте исключение для Python

## Решение 5: Использование другого API

Если проблемы с SSL продолжаются, рассмотрите использование других API провайдеров:
- Прямое подключение к OpenAI (если доступно в вашем регионе)
- Другие модели через OpenRouter, которые могут работать лучше
- Альтернативные API провайдеры

## Диагностика

Для диагностики проблемы выполните:

```powershell
# Проверка версии Python и SSL
python -c "import ssl; print(ssl.OPENSSL_VERSION)"

# Проверка подключения к OpenRouter
python -c "import requests; r = requests.get('https://openrouter.ai/api/v1/models'); print(r.status_code)"

# Проверка сертификатов
python -c "import certifi; print(certifi.where())"
```

## Дополнительная информация

- [Документация certifi](https://github.com/certifi/python-certifi)
- [Документация requests по SSL](https://requests.readthedocs.io/en/latest/user/advanced/#ssl-cert-verification)
- [OpenRouter API документация](https://openrouter.ai/docs)


